import { AuthService } from './../auth/auth.service';
import { Place } from './place.model';
import { Injectable } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
import { take, map, tap, delay } from 'rxjs/operators'

@Injectable({
    providedIn: 'root'
})
export class PlacesService {

    private _places = new BehaviorSubject<Place[]>(
        [
            new Place('P6', 'Dakhla', 'The jewel of Moroccan ', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSAl7wu9mBWaILTZapQwbPrUnLu2Rvfyd7hNA&usqp=CAU', 400, new Date('2021-03-21'), new Date('2023-04-01'), 'abc'),
            new Place('P1', 'Chefchaouen', 'Blue Beauty of North Morocco', 'https://resize-parismatch.lanmedia.fr/f/webp/r/625/img/var/news/storage/images/paris-match/vivre/voyage/chefchaouen-la-ville-instagram-1656667/img-20191019-1422256/27026091-1-fre-FR/IMG-20191019-1422256.jpg', 350, new Date('2021-03-19'), new Date('2021-12-31'), 'abc'),
            new Place('P2', 'Marrakech', 'Famous Moroccan city', 'https://www.challenge.ma/wp-content/uploads/2020/10/ou-dormir-a-marrakech-740x454-1.jpg', 500, new Date('2021-03-22'), new Date('2021-12-31'), 'abc'),
            new Place('P3', 'Casablanca', 'The Heart of Moroccan Economie', 'https://img-4.linternaute.com/8FogTwdPZx-0bxE2Zpy3FtNkEq4=/660x366/smart/137d8bcc5c0f4d26b9db6f4b3401f032/ccmcms-linternaute/14684585.jpg', 300, new Date('2021-04-01'), new Date('2022-12-31'), 'abc'),
            new Place('P4', 'Tanger', 'Combined Moroccan European Style', 'https://lh3.googleusercontent.com/proxy/RHr_C2XkXmswIJ8HXfZXTSmrbKpvYR5b-sqvnGToqfTy_DyYsatOrH1XhcAv53pM0WPAk3KHVy-8sO3oxx-S3wycs1kOkTt4WjObmRICpLtS0BD0nAE3Kg', 400, new Date('2021-03-21'), new Date('2023-04-01'), 'xyz'),
            new Place('P5', 'Rabat', 'Capital of Moroccan ', 'data:image/jpeg;base64,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', 400, new Date('2021-03-21'), new Date('2023-04-01'), 'abc'),
        ]
    );

    get places() {
        return this._places.asObservable();
    }

    constructor(private authService: AuthService) { }

    getPlace(placeId: string) {
        return this.places.pipe(
            take(1),
            map(places => {
                return { ...places.find(p => p.id === placeId) };
            })
        );

    }

    addPlace(title: string, description: string, price: number, dateFrom: Date, dateTo: Date) {
        const newPlace = new Place(Math.random().toString(), title, description, 'https://www.challenge.ma/wp-content/uploads/2020/10/ou-dormir-a-marrakech-740x454-1.jpg', price, dateFrom, dateTo, this.authService.userId);

        return this.places.pipe(take(1), delay(1000), tap(places => {
            this._places.next(places.concat(newPlace));
        }));
    }

    updatePlace(placeId: string, title: string, description: string) {
        return this.places.pipe(take(1), delay(1000), tap(places => {
            const updatedPlaceIndex = places.findIndex(pl => pl.id === placeId);
            const updatedPlaces = [...places];
            const oldPlace = updatedPlaces[updatedPlaceIndex];
            updatedPlaces[updatedPlaceIndex] = new Place(
                oldPlace.id,
                title,
                description,
                oldPlace.imageUrl,
                oldPlace.price,
                oldPlace.availableFrom,
                oldPlace.availableTo,
                oldPlace.userId);
            this._places.next(updatedPlaces);
        }))
    }
}
